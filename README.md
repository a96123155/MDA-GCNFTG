# MDA-GKNN: Identifying miRNA-disease associations based on graph neural network and k-nearest neighbors
It is proved that identifying the miRNA-disease association (MDA) helps to understand the etiology and mechanisms of many diseases. It is urgent to develop effective computational methods to reduce time and cost of traditional experimental methods.
This study proposes a MDA-GKNN method which consists of a novel graph neural network (GNN) model for MDA prediction based on the k-nearest neighbors (k-NN) edge-building strategy. This method regards the MDA prediction problem as a node classification problem, and identifies potential MDA in an end-to-end manner. First, the miRNA-disease pair (MDP) graph is constructed through integrated similarity and k-NN algorithm, which realizes the effective fusion of heterogeneity. Then, the edge sampler-based graph sampling technique is applied on the training graph to obtain the subgraph, and then the full graph convolutional network (GCN) algorithm is executed on the subgraph to predict the potential MDA. In the experiment, we established 5-fold cross-validation (CV) on six tasks. These tasks cover most MDA prediction situations and consist of three experimental settings (predicting new MDPs, miRNAs and diseases) and two data distributions (balanced and unbalanced). This is the first time that these tasks have been considered simultaneously.
The experimental results show that the MDA-GKNN method has achieved satisfactory performance on all six tasks, and significantly superior to the classic machine learning methods and the most advanced methods of MDA prediction. In addition, the effectiveness of k-NN and novel GNN in MDA-GKNN has also been demonstrated. More Importantly, case studies for two diseases and three miRNAs are conducted and achieved satisfactory performance.

## File explanation
### data folder
- D_SSM1 and D_SSM2: disease semantic similarity
- M_FSM: miRNA functional similarity
- D_GSM: Gaussian interaction profile kernel similarity for diseases
- M_GSM: Gaussian interaction profile kernel similarity for miRNAs
- all_mirna_disease_pairs: positive samples (i.e. MDA)
- disease_name: The disease id and name
- miRNA_name: The miRNA id and name

### code folder
- 1_Construct MDP graph.ipynb and 2_data preprocessing to model.ipynb are the first two code need to implement before train model.
- parameters.yml is the GNN parameters configuration file.

#### compared methods folder
The implementation of random forest, extremely randomized trees, Gaussian naivy Bayes, decision trees, SVM, graph convolutional network, GAMEDA
It is worthy to note that the DNN is implemented through Keras.
#### MDA-GKNN folder
It contains the pytorch code for MDA-GKNN.

### prediction results folder
The MDA prediction results on six tasks, which contain y_train, y_test, y_train_pred, y_test_pred

### case study folder
- *.ipynb: Do the case study
- database_file汇总：all MDA data from HMDD V3.2, miR2Disease, dbDEMC databases
#### results folder
- case_study_*.txt: generated by the above four .ipynb, represent whether each new MDA is verified
- others: The case study for specific miRNAs and diseases

## Run the MDA-GKNN
1. pip install -r MDA-GKNN_requirements.txt
2. 1_Construct MDP graph.ipynb
3. 2_data preprocessing to model.ipynb
4. Train and test, for example:
python -m MDA-GKNN.pytorch_version.train_nobalance_weight_saveys_Tm --data_prefix miRNA_disease_data/task_Tm__nobalance__testlabel0_15knn_edge_fold3 --train_config parameters.yml > 20200118_Tm_unbalanced_15knn_lr0.01_weight10_fold3.out --gpu 1
